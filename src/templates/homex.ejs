; homex.g
; called to home the X axis
;
; generated by RepRapFirmware Configuration Tool v2 on <%- (new Date()).toString() %>
G91 ; relative positioning
G1 Z<%- template.z_dive_height %> F<%- template.travel_speed * 60 %> S2 ; lift Z relative to current position
<%	if (template.drives[0].endstop_type == 3) {
		if (template.probe.deploy && template.firmware < 1.21) { -%>
M98 Pdeployprobe.g ; deploy mechanical Z probe
<%		}
		if (template.probe.type == "modulated") { -%>
M558 P1 ; set Z probe to unmodulated mode (required for RRP 4-wire probe)
<%		}
	}

	let travelTo = Math.abs(template.geometry.mins[0]) + Math.abs(template.geometry.maxes[0]) + 5;
	let travelBack = -5;
	if (template.drives[0].endstop_location == 1) {
		travelTo *= -1;
		travelBack *= -1;
	} -%>
G1 S1 X<%- travelTo %> F<%- template.homing_speed_fast * 60 %> ; move quickly to X axis endstop and stop there (first pass)
G1 X<%- travelBack %> F<%- template.travel_speed * 60 %> ; go back a few mm
G1 S1 X<%- travelTo %> F<%- template.homing_speed_slow * 60 %> ; move slowly to X axis endstop once more (second pass)
<%	if (template.drives[0].endstop_type == 3) {
		if (template.probe.deploy && template.firmware < 1.21) { -%>
M98 Pretractprobe.g ; retract the mechanical Z probe
<%		}
		if (template.probe.type == "modulated") { -%>
M558 P2 ; set Z probe back to modulated mode
<%		}
	} -%>
G1 Z<%- -template.z_dive_height %> F<%- template.travel_speed * 60 %> S2 ; lower Z again
G90 ; absolute positioning
